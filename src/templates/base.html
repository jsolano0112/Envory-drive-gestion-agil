{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}EVORY DRIVE{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex">

  <!-- Barra lateral fija -->
  <aside class="w-20 bg-white shadow-lg flex flex-col items-center py-6 space-y-8 z-50 relative">
    <!-- Logo original -->
    <svg class="w-10 h-10 text-sky-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
      <path d="M2 17l10 5 10-5"></path>
      <path d="M2 12l10 5 10-5"></path>
    </svg>

    <!-- Inicio -->
    <a href="{% url 'home' %}" class="text-sky-600 hover:text-sky-800" title="Inicio">
      <svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M13 5v6h6"></path>
      </svg>
    </a>

    <!-- Buscar conductor -->
    <a href="{% url 'driver_history' %}" class="text-sky-600 hover:text-sky-800" title="Buscar conductor">
      <svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
      </svg>
    </a>

    <!-- Perfil -->
    <div class="relative">
      <button id="toggleProfile" class="text-sky-600 hover:text-sky-800" title="Perfil">
        <svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path d="M5.121 17.804A4 4 0 0112 14a4 4 0 016.879 3.804M12 14v1m0 4h.01"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
      </button>

      <!-- Menú desplegable de perfil -->
      <div id="profileMenu" class="absolute left-12 top-0 w-64 bg-white text-gray-800 shadow-lg rounded-lg p-4 space-y-2 hidden z-50">
        <h3 class="text-lg font-bold text-sky-600 mb-2">Tu Perfil</h3>
        <p><strong>Nombre:</strong> {{ request.user.first_name }} {{ request.user.last_name }}</p>
        <p><strong>Usuario:</strong> {{ request.user.username }}</p>
        <p><strong>Email:</strong> {{ request.user.email }}</p>
        <p><strong>Ingreso:</strong> {{ request.user.date_joined|date:"d/m/Y H:i" }}</p>
        {% if request.user.cliente %}
          <p><strong>Empresa:</strong> {{ request.user.cliente.compania.nombre }}</p>
        {% else %}
          <p><strong>Empresa:</strong> —</p>
        {% endif %}
        <a href="{% url 'logout' %}" class="block text-center bg-sky-600 text-white font-semibold py-2 rounded hover:bg-sky-700 transition">
          Salir
        </a>
      </div>
    </div>
  </aside>

  <!-- Contenido principal -->
  <div class="flex-1 p-8">
    <header class="mb-8">
      <h1 class="text-3xl font-bold text-gray-800">{% block page_title %}EVORY DRIVE{% endblock %}</h1>
      <p class="text-gray-600 mt-1">{% block page_subtitle %}Bienvenido{% endblock %}</p>
    </header>

    {% block content %}{% endblock %}
  </div>

  <!-- Script para mostrar/ocultar el menú de perfil -->
  <script>
    const toggleBtn = document.getElementById("toggleProfile");
    const profileMenu = document.getElementById("profileMenu");

    toggleBtn.addEventListener("click", () => {
      profileMenu.classList.toggle("hidden");
    });

    document.addEventListener("click", (event) => {
      const isClickInside = profileMenu.contains(event.target);
      const isClickOnToggle = toggleBtn.contains(event.target);
      if (!isClickInside && !isClickOnToggle) {
        profileMenu.classList.add("hidden");
      }
    });
  </script>
</body>
</html>
